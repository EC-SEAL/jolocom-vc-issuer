{"ast":null,"code":"var __jsx = React.createElement;\nimport React from \"react\";\nimport axios from \"axios\";\nimport { setSessionData, makeOnlyConnectionRequest, addSetToSelection, setStepperSteps, setEndpoint, setBaseUrl, setServerSessionId, completeDIDAuth, makeSealSession, makeSealSessionWithDIDConnecetionRequest, setSealSession, setEdugainUriPort, setEdugainRedirectUri } from \"../../../store\";\nimport Layout from \"../../../components/Layout\";\nimport { connect } from \"react-redux\";\nimport { Button, Row, Col, Card, Container } from \"react-bootstrap\";\nimport MyStepper from \"../../../components/Stepper\";\nimport HomeButton from \"../../../components/HomeButton\";\nimport IssueVCButton from \"../../../components/IssueVCButton\";\nimport PairOrCard from \"../../../components/PairOrCard\";\nimport ConnectMobile from \"../../../components/ConnectMobile\";\nimport isMobile from \"../../../helpers/isMobile\";\n/*\n  Secure flow:\n  - check in session if DID is present. This is not only the DID of the user but the whole connection response\n  - if it is not present:\n    - first display DID connection request (QR etc.). The DID response endpoint should contain the session here\n    - on response on the server, send a SSE to the front end, denoting that DID auth is completed and on the server there is the DID component\n    - Display additional datasources\n    - on VC issance request, do not display QR code etc, but send the credentials straigth to the users wallet\n\n*/\n\nclass IssueEdugain extends React.Component {\n  constructor(props) {\n    super(props);\n    this.dispatch = props.dispatch;\n    this.isFetching = props.isFetching;\n    this.sessionData = props.sessionData;\n    this.proceedWithAuthentication = this.proceedWithAuthentication.bind(this);\n    this.hasRequiredAttributes = props.sessionData !== null && props.sessionData !== undefined && props.sessionData.edugain !== undefined;\n  }\n\n  static async getInitialProps({\n    reduxStore,\n    req\n  }) {\n    let userSessionData;\n    let DIDOk;\n    let sealSession;\n\n    if (true) {\n      userSessionData = req.session.userData;\n      reduxStore.dispatch(setEndpoint(req.session.enpoint));\n      let baseUrl = req.session.baseUrl ? `/${req.session.baseUrl}/` : \"\";\n      reduxStore.dispatch(setBaseUrl(baseUrl));\n      reduxStore.dispatch(setServerSessionId(req.session.id));\n      DIDOk = req.session.DID;\n      sealSession = req.session.sealSession;\n      console.log(`edugainjs:: in the server the seal session is:: ${req.session.sealSession}`);\n      reduxStore.dispatch(setEdugainUriPort(req.edugainUri, req.edugainPort));\n      reduxStore.dispatch(setEdugainRedirectUri(req.edugainRedirectUri));\n    } else {\n      if (reduxStore.getState().sessionData) {\n        userSessionData = reduxStore.getState().sessionData;\n        DIDOk = reduxStore.getState().DID; //if ther is sessionData then there should be a session as well\n\n        sealSession = reduxStore.getState().sealSession;\n      } else {\n        console.log(`no server session data found`);\n      }\n    } //this way the userSessionData gets set in all settings\n\n\n    if (userSessionData) {\n      console.log(\"edugain.js:: will setSessionData\");\n      console.log(userSessionData);\n      reduxStore.dispatch(setSessionData(userSessionData));\n    }\n\n    if (DIDOk) {\n      console.log(\"edugain.js:: will set completeDIDAuth\");\n      reduxStore.dispatch(completeDIDAuth(sealSession));\n    }\n\n    if (sealSession) {\n      console.log(\"edugain.js:: will set sealSession\");\n      console.log(sealSession);\n      reduxStore.dispatch(setSealSession(sealSession));\n    } //returned value here is getting mered with the mapstatetoprops\n    // mapstatetoprops overrides these values if they match\n\n\n    return {\n      sessionData: userSessionData,\n      qrData: reduxStore.getState().qrData,\n      vcSent: false,\n      sealSession: reduxStore.getState().sealSession\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"edugain.js:: componentDIDMount\");\n\n    if (this.props.sessionData && this.props.sessionData.edugain) {\n      console.log(`edugain.js :: the data is ${this.props.sessionData.edugain}`);\n      let toSelect = [this.props.sessionData.edugain];\n      this.props.setEdugainToSelection(toSelect);\n    }\n\n    if (!this.props.DID) {\n      //if DID auth has not been completed\n      // console.log(`${new Date()} DID not found`);\n      if (!this.props.sealSession) {\n        // console.log(\"startSealSessionAndDidAuth\")\n        console.log(`isMobile ${isMobile()}`);\n        this.props.startSealSessionAndDidAuth(this.props.baseUrl, \"edugain\", isMobile()); //and then makeConnectionRequest\n      } else {\n        // console.log(\"makeConnectionRequest\")\n        console.log(`isMobile ${isMobile()}`);\n        this.props.makeConnectionRequest(this.props.sealSession, this.props.baseUrl, \"edugain\", isMobile());\n      }\n    }\n\n    axios.get(`${this.props.baseUrl}/vc/make-edugain-callback-token?sessionId=${this.props.sealSession}`).then(data => {\n      axios.post(`${this.props.baseUrl}seal/update-session`, {\n        sessionId: this.props.sealSession,\n        variableName: \"ClientCallbackAddr\",\n        variableValue: `${this.props.edugainRedirectUri}?msToken=${data.data.additionalData}`\n      }).then(data => {\n        //the edugain ms expects an empty datastore object to exist in session\n        axios.post(`${this.props.baseUrl}seal/update-session`, {\n          sessionId: this.props.sealSession,\n          variableName: \"dataStore\",\n          variableValue: JSON.stringify({})\n        }).then(data => {\n          console.log(\"edugain.js:: session updated\");\n        });\n      });\n    });\n  }\n\n  componentDidUpdate() {\n    console.log(`edugain.js:: componentDidUpdate ${this.hasRequiredAttributes}`);\n\n    if (this.props.DID & !this.hasRequiredAttributes) {\n      //if DID auth is completed\n      // register the callbackUri to the SessionManager\n      axios.get(`${this.props.baseUrl}/vc/make-edugain-callback-token?sessionId=${this.props.sealSession}`).then(data => {\n        axios.post(`${this.props.baseUrl}seal/update-session`, {\n          sessionId: this.props.sealSession,\n          variableName: \"ClientCallbackAddr\",\n          variableValue: `${this.props.edugainRedirectUri}?msToken=${data.data.additionalData}`\n        }).then(data => {\n          //the edugain ms expects an empty datastore object to exist in session\n          axios.post(`${this.props.baseUrl}seal/update-session`, {\n            sessionId: this.props.sealSession,\n            variableName: \"dataStore\",\n            variableValue: JSON.stringify({})\n          }).then(data => {\n            console.log(\"edugain.js:: session updated\");\n          });\n        });\n      });\n    }\n  }\n\n  proceedWithAuthentication() {\n    axios.get(`${this.props.baseUrl}/vc/make-edugain-token?sessionId=${this.props.sealSession}`).then(data => {\n      console.log(\"***********\");\n      console.log(this.props.edugainUri);\n      console.log(this.props.edugainUri.indexOf(\"https\" >= 0));\n      let theUrl = this.props.edugainUri.indexOf(\"https\" >= 0) ? this.props.edugainUri : `http://${this.props.edugainUri}`;\n      console.log(\"!!!!!\");\n      console.log(`${theUrl}:${this.props.edugainPort}/is/query?msToken=${data.data.additionalData}`);\n      window.location.href = `${theUrl}:${this.props.edugainPort}/is/query?msToken=${data.data.additionalData}`;\n    });\n  }\n\n  render() {\n    let stepNumber = !this.props.DID ? 0 : this.hasRequiredAttributes ? 2 : 1;\n    let stepperSteps = [{\n      title: \"Pair your wallet\"\n    }, {\n      title: 'Authenticate over \"eduGAIN\"'\n    }, {\n      title: \"Request Issuance\"\n    }];\n\n    if (this.props.qrData && isMobile() && !this.props.DID) {\n      return __jsx(Layout, null, __jsx(Row, null, __jsx(Col, null, __jsx(MyStepper, {\n        steps: stepperSteps,\n        activeNum: stepNumber\n      }))), __jsx(ConnectMobile, {\n        baseUrl: this.props.baseUrl,\n        qrData: this.props.qrData,\n        DID: this.props.DID,\n        uuid: this.props.uuid,\n        serverSessionId: this.props.serverSessionId,\n        sealSession: this.props.sealSession\n      }));\n    }\n\n    let edugainLoginButton = !this.hasRequiredAttributes ? __jsx(Button, {\n      onClick: this.proceedWithAuthentication\n    }, \"eduGAIN\") : __jsx(Button, {\n      variant: \"primary\",\n      disabled: true\n    }, \"eduGAIN\");\n\n    let issueVCBut = __jsx(IssueVCButton, {\n      hasRequiredAttributes: this.hasRequiredAttributes // vcIssuanceEndpoint={\"/issueVCSecure\"}\n      ,\n      baseUrl: this.props.baseUrl,\n      userSelection: this.props.userSelection,\n      uuid: this.props.sealSession,\n      vcType: \"SEAL-EDUGAIN\"\n    });\n\n    let edugainCard = __jsx(Card, {\n      className: \"text-center\",\n      style: {\n        marginTop: \"2rem\"\n      }\n    }, __jsx(Card.Header, null, \"Issue an EDUGAIN based Verifiable Credential\"), __jsx(Card.Body, null, __jsx(Card.Title, null, this.hasRequiredAttributes ? \"Credentials Issuance is ready!\" : \"Please authenticate to the required data sources\"), __jsx(Card.Text, null, \"Once you have authenticated through the required data sources, click the \\\"Issue\\\" button to generate and receive your VC .\"), __jsx(Container, null, __jsx(Row, null, __jsx(Col, null, edugainLoginButton), __jsx(Col, null, issueVCBut)))));\n\n    let result = __jsx(PairOrCard, {\n      qrData: this.props.qrData,\n      DID: this.props.DID,\n      baseUrl: this.props.baseUrl,\n      uuid: this.props.uuid,\n      serverSessionId: this.props.serverSessionId,\n      card: edugainCard,\n      vcSent: this.props.vcSent,\n      sealSession: this.props.sealSession,\n      credQROffer: this.props.credQROffer\n    });\n\n    return __jsx(Layout, null, __jsx(Row, null, __jsx(Col, null, __jsx(MyStepper, {\n      steps: stepperSteps,\n      activeNum: stepNumber\n    }))), result, __jsx(Row, null, __jsx(HomeButton, {\n      baseUrl: this.props.baseUrl\n    })));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    isFetching: state.fetching,\n    qrData: state.qrData,\n    sessionData: state.sessionData,\n    userSelection: state.userSelection,\n    // the attributes selected by the user to be included in a VC,\n    baseUrl: state.baseUrl,\n    DID: state.DID,\n    serverSessionId: state.serverSessionId,\n    uuid: state.uuid,\n    vcSent: state.vcSent,\n    sealSession: state.sealSession,\n    edugainUri: state.edugainUri,\n    edugainPort: state.edugainPort,\n    endpoint: state.endpoint,\n    edugainRedirectUri: state.edugainRedirectUri,\n    credQROffer: state.credQROffer\n  };\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setEdugainToSelection: set => {\n      dispatch(addSetToSelection(set));\n    },\n    setSteps: steps => {\n      dispatch(setStepperSteps(steps));\n    },\n    setEndPoint: endpont => {\n      dispatch(setEndpoint(endpoint));\n    },\n    makeConnectionRequest: (sealSession, baseUrl, vcType, isMobile) => {\n      dispatch(makeOnlyConnectionRequest(sealSession, baseUrl, vcType, isMobile));\n    },\n    didAuthOK: uuid => {\n      dispatch(completeDIDAuth(uuid));\n    },\n    startSealSession: baseUrl => {\n      dispatch(makeSealSession(baseUrl));\n    },\n    startSealSessionAndDidAuth: (baseUrl, vcType, isMobile) => {\n      dispatch(makeSealSessionWithDIDConnecetionRequest(baseUrl, vcType, isMobile));\n    },\n    setTheSealSession: sessionId => {\n      dispatch(setSealSession(sessionId));\n    },\n    setEdugain: (uri, data) => {\n      dispatch(setEdugainUriPort(uri, data));\n    },\n    setEdugainRedirect: uri => {\n      dispatch(setEdugainRedirectUri(uri));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(IssueEdugain);","map":{"version":3,"sources":["/home/ni/code/js/jolocom-seal-issuer/pages/vc/issue/edugain.js"],"names":["React","axios","setSessionData","makeOnlyConnectionRequest","addSetToSelection","setStepperSteps","setEndpoint","setBaseUrl","setServerSessionId","completeDIDAuth","makeSealSession","makeSealSessionWithDIDConnecetionRequest","setSealSession","setEdugainUriPort","setEdugainRedirectUri","Layout","connect","Button","Row","Col","Card","Container","MyStepper","HomeButton","IssueVCButton","PairOrCard","ConnectMobile","isMobile","IssueEdugain","Component","constructor","props","dispatch","isFetching","sessionData","proceedWithAuthentication","bind","hasRequiredAttributes","undefined","edugain","getInitialProps","reduxStore","req","userSessionData","DIDOk","sealSession","session","userData","enpoint","baseUrl","id","DID","console","log","edugainUri","edugainPort","edugainRedirectUri","getState","qrData","vcSent","componentDidMount","toSelect","setEdugainToSelection","startSealSessionAndDidAuth","makeConnectionRequest","get","then","data","post","sessionId","variableName","variableValue","additionalData","JSON","stringify","componentDidUpdate","indexOf","theUrl","window","location","href","render","stepNumber","stepperSteps","title","uuid","serverSessionId","edugainLoginButton","issueVCBut","userSelection","edugainCard","marginTop","result","credQROffer","mapStateToProps","state","fetching","endpoint","mapDispatchToProps","set","setSteps","steps","setEndPoint","endpont","vcType","didAuthOK","startSealSession","setTheSealSession","setEdugain","uri","setEdugainRedirect"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport {\n  setSessionData,\n  makeOnlyConnectionRequest,\n  addSetToSelection,\n  setStepperSteps,\n  setEndpoint,\n  setBaseUrl,\n  setServerSessionId,\n  completeDIDAuth,\n  makeSealSession,\n  makeSealSessionWithDIDConnecetionRequest,\n  setSealSession,\n  setEdugainUriPort,\n  setEdugainRedirectUri,\n} from \"../../../store\";\nimport Layout from \"../../../components/Layout\";\nimport { connect } from \"react-redux\";\nimport { Button, Row, Col, Card, Container } from \"react-bootstrap\";\nimport MyStepper from \"../../../components/Stepper\";\nimport HomeButton from \"../../../components/HomeButton\";\nimport IssueVCButton from \"../../../components/IssueVCButton\";\nimport PairOrCard from \"../../../components/PairOrCard\";\nimport ConnectMobile from \"../../../components/ConnectMobile\";\nimport isMobile from \"../../../helpers/isMobile\";\n\n/*\n  Secure flow:\n  - check in session if DID is present. This is not only the DID of the user but the whole connection response\n  - if it is not present:\n    - first display DID connection request (QR etc.). The DID response endpoint should contain the session here\n    - on response on the server, send a SSE to the front end, denoting that DID auth is completed and on the server there is the DID component\n    - Display additional datasources\n    - on VC issance request, do not display QR code etc, but send the credentials straigth to the users wallet\n\n*/\n\nclass IssueEdugain extends React.Component {\n  constructor(props) {\n    super(props);\n    this.dispatch = props.dispatch;\n    this.isFetching = props.isFetching;\n    this.sessionData = props.sessionData;\n    this.proceedWithAuthentication = this.proceedWithAuthentication.bind(this);\n    this.hasRequiredAttributes =\n      props.sessionData !== null &&\n      props.sessionData !== undefined &&\n      props.sessionData.edugain !== undefined;\n  }\n\n  static async getInitialProps({ reduxStore, req }) {\n    let userSessionData;\n    let DIDOk;\n    let sealSession;\n    if (typeof window === \"undefined\") {\n      userSessionData = req.session.userData;\n      reduxStore.dispatch(setEndpoint(req.session.enpoint));\n      let baseUrl = req.session.baseUrl ? `/${req.session.baseUrl}/` : \"\";\n      reduxStore.dispatch(setBaseUrl(baseUrl));\n      reduxStore.dispatch(setServerSessionId(req.session.id));\n      DIDOk = req.session.DID;\n      sealSession = req.session.sealSession;\n\n      console.log(\n        `edugainjs:: in the server the seal session is:: ${req.session.sealSession}`\n      );\n      reduxStore.dispatch(setEdugainUriPort(req.edugainUri, req.edugainPort));\n      reduxStore.dispatch(setEdugainRedirectUri(req.edugainRedirectUri));\n    } else {\n      if (reduxStore.getState().sessionData) {\n        userSessionData = reduxStore.getState().sessionData;\n        DIDOk = reduxStore.getState().DID;\n        //if ther is sessionData then there should be a session as well\n        sealSession = reduxStore.getState().sealSession;\n      } else {\n        console.log(`no server session data found`);\n      }\n    }\n\n    //this way the userSessionData gets set in all settings\n    if (userSessionData) {\n      console.log(\"edugain.js:: will setSessionData\")\n      console.log(userSessionData)\n      reduxStore.dispatch(setSessionData(userSessionData));\n    }\n    if (DIDOk) {\n      console.log(\"edugain.js:: will set completeDIDAuth\")\n      reduxStore.dispatch(completeDIDAuth(sealSession));\n    }\n    if (sealSession) {\n      console.log(\"edugain.js:: will set sealSession\")\n      console.log(sealSession)\n      reduxStore.dispatch(setSealSession(sealSession));\n    }\n\n    //returned value here is getting mered with the mapstatetoprops\n    // mapstatetoprops overrides these values if they match\n    return {\n      sessionData: userSessionData,\n      qrData: reduxStore.getState().qrData,\n      vcSent: false,\n      sealSession: reduxStore.getState().sealSession,\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"edugain.js:: componentDIDMount\")\n    if (this.props.sessionData && this.props.sessionData.edugain) {\n      console.log(`edugain.js :: the data is ${this.props.sessionData.edugain}`)\n      let toSelect = [this.props.sessionData.edugain];\n      this.props.setEdugainToSelection(toSelect);\n    }\n\n    if (!this.props.DID) {\n      //if DID auth has not been completed\n      // console.log(`${new Date()} DID not found`);\n      if (!this.props.sealSession) {\n        // console.log(\"startSealSessionAndDidAuth\")\n        console.log(`isMobile ${isMobile()}`);\n\n        this.props.startSealSessionAndDidAuth(\n          this.props.baseUrl,\n          \"edugain\",\n          isMobile()\n        ); //and then makeConnectionRequest\n      } else {\n        // console.log(\"makeConnectionRequest\")\n        console.log(`isMobile ${isMobile()}`);\n        this.props.makeConnectionRequest(\n          this.props.sealSession,\n          this.props.baseUrl,\n          \"edugain\",\n          isMobile()\n        );\n      }\n    }\n\n    axios\n      .get(\n        `${this.props.baseUrl}/vc/make-edugain-callback-token?sessionId=${this.props.sealSession}`\n      )\n      .then((data) => {\n        axios\n          .post(`${this.props.baseUrl}seal/update-session`, {\n            sessionId: this.props.sealSession,\n            variableName: \"ClientCallbackAddr\",\n            variableValue: `${this.props.edugainRedirectUri}?msToken=${data.data.additionalData}`,\n          })\n          .then((data) => {\n            //the edugain ms expects an empty datastore object to exist in session\n            axios\n              .post(`${this.props.baseUrl}seal/update-session`, {\n                sessionId: this.props.sealSession,\n                variableName: \"dataStore\",\n                variableValue: JSON.stringify({}),\n              })\n              .then((data) => {\n                console.log(\"edugain.js:: session updated\");\n              });\n          });\n      });\n\n\n  }\n\n  componentDidUpdate() {\n    console.log(`edugain.js:: componentDidUpdate ${this.hasRequiredAttributes}`)\n\n\n    if (this.props.DID & !this.hasRequiredAttributes) {\n      //if DID auth is completed\n      // register the callbackUri to the SessionManager\n      axios\n        .get(\n          `${this.props.baseUrl}/vc/make-edugain-callback-token?sessionId=${this.props.sealSession}`\n        )\n        .then((data) => {\n          axios\n            .post(`${this.props.baseUrl}seal/update-session`, {\n              sessionId: this.props.sealSession,\n              variableName: \"ClientCallbackAddr\",\n              variableValue: `${this.props.edugainRedirectUri}?msToken=${data.data.additionalData}`,\n            })\n            .then((data) => {\n              //the edugain ms expects an empty datastore object to exist in session\n              axios\n                .post(`${this.props.baseUrl}seal/update-session`, {\n                  sessionId: this.props.sealSession,\n                  variableName: \"dataStore\",\n                  variableValue: JSON.stringify({}),\n                })\n                .then((data) => {\n                  console.log(\"edugain.js:: session updated\");\n                });\n            });\n        });\n    }\n  }\n\n  proceedWithAuthentication() {\n    axios\n      .get(\n        `${this.props.baseUrl}/vc/make-edugain-token?sessionId=${this.props.sealSession}`\n      )\n      .then((data) => {\n        console.log(\"***********\")\n        console.log(this.props.edugainUri)\n        console.log(this.props.edugainUri.indexOf(\"https\" >= 0))\n        let theUrl = this.props.edugainUri.indexOf(\"https\" >= 0)\n          ? this.props.edugainUri\n          : `http://${this.props.edugainUri}`;\n\n          console.log(\"!!!!!\")\n          console.log(`${theUrl}:${this.props.edugainPort}/is/query?msToken=${data.data.additionalData}`)\n          window.location.href = `${theUrl}:${this.props.edugainPort}/is/query?msToken=${data.data.additionalData}`;\n      });\n  }\n\n  render() {\n    let stepNumber = !this.props.DID ? 0 : this.hasRequiredAttributes ? 2 : 1;\n    let stepperSteps = [\n      { title: \"Pair your wallet\" },\n      { title: 'Authenticate over \"eduGAIN\"' },\n      { title: \"Request Issuance\" },\n    ];\n\n    if (this.props.qrData && isMobile() && !this.props.DID) {\n      return (\n        <Layout>\n          <Row>\n            <Col>\n              <MyStepper steps={stepperSteps} activeNum={stepNumber} />\n            </Col>\n          </Row>\n          <ConnectMobile\n            baseUrl={this.props.baseUrl}\n            qrData={this.props.qrData}\n            DID={this.props.DID}\n            uuid={this.props.uuid}\n            serverSessionId={this.props.serverSessionId}\n            sealSession={this.props.sealSession}\n          />\n        </Layout>\n      );\n    }\n\n    let edugainLoginButton = !this.hasRequiredAttributes ? (\n      <Button onClick={this.proceedWithAuthentication}>eduGAIN</Button>\n    ) : (\n        <Button variant=\"primary\" disabled>\n          eduGAIN\n        </Button>\n      );\n\n    let issueVCBut = (\n      <IssueVCButton\n        hasRequiredAttributes={this.hasRequiredAttributes}\n        // vcIssuanceEndpoint={\"/issueVCSecure\"}\n        baseUrl={this.props.baseUrl}\n        userSelection={this.props.userSelection}\n        uuid={this.props.sealSession}\n        vcType={\"SEAL-EDUGAIN\"}\n      />\n    );\n\n    let edugainCard = (\n      <Card className=\"text-center\" style={{ marginTop: \"2rem\" }}>\n        <Card.Header>Issue an EDUGAIN based Verifiable Credential</Card.Header>\n        <Card.Body>\n          <Card.Title>\n            {this.hasRequiredAttributes\n              ? \"Credentials Issuance is ready!\"\n              : \"Please authenticate to the required data sources\"}\n          </Card.Title>\n          <Card.Text>\n            Once you have authenticated through the required data sources, click\n            the \"Issue\" button to generate and receive your VC .\n          </Card.Text>\n          <Container>\n            <Row>\n              <Col>{edugainLoginButton}</Col>\n              <Col>{issueVCBut}</Col>\n            </Row>\n          </Container>\n        </Card.Body>\n        {/* <Card.Footer className=\"text-muted\">2 days ago</Card.Footer> */}\n      </Card>\n    );\n\n    let result = (\n      <PairOrCard\n        qrData={this.props.qrData}\n        DID={this.props.DID}\n        baseUrl={this.props.baseUrl}\n        uuid={this.props.uuid}\n        serverSessionId={this.props.serverSessionId}\n        card={edugainCard}\n        vcSent={this.props.vcSent}\n        sealSession={this.props.sealSession}\n        credQROffer={this.props.credQROffer}\n      />\n    );\n\n    return (\n      <Layout>\n        <Row>\n          <Col>\n            <MyStepper steps={stepperSteps} activeNum={stepNumber} />\n          </Col>\n        </Row>\n        {result}\n\n        <Row>\n          <HomeButton baseUrl={this.props.baseUrl} />\n        </Row>\n      </Layout>\n    );\n  }\n}\nfunction mapStateToProps(state) {\n  return {\n    isFetching: state.fetching,\n    qrData: state.qrData,\n    sessionData: state.sessionData,\n    userSelection: state.userSelection, // the attributes selected by the user to be included in a VC,\n    baseUrl: state.baseUrl,\n    DID: state.DID,\n    serverSessionId: state.serverSessionId,\n    uuid: state.uuid,\n    vcSent: state.vcSent,\n    sealSession: state.sealSession,\n    edugainUri: state.edugainUri,\n    edugainPort: state.edugainPort,\n    endpoint: state.endpoint,\n    edugainRedirectUri: state.edugainRedirectUri,\n    credQROffer: state.credQROffer,\n  };\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    setEdugainToSelection: (set) => {\n      dispatch(addSetToSelection(set));\n    },\n    setSteps: (steps) => {\n      dispatch(setStepperSteps(steps));\n    },\n    setEndPoint: (endpont) => {\n      dispatch(setEndpoint(endpoint));\n    },\n    makeConnectionRequest: (sealSession, baseUrl, vcType, isMobile) => {\n      dispatch(\n        makeOnlyConnectionRequest(sealSession, baseUrl, vcType, isMobile)\n      );\n    },\n    didAuthOK: (uuid) => {\n      dispatch(completeDIDAuth(uuid));\n    },\n    startSealSession: (baseUrl) => {\n      dispatch(makeSealSession(baseUrl));\n    },\n    startSealSessionAndDidAuth: (baseUrl, vcType, isMobile) => {\n      dispatch(\n        makeSealSessionWithDIDConnecetionRequest(baseUrl, vcType, isMobile)\n      );\n    },\n    setTheSealSession: (sessionId) => {\n      dispatch(setSealSession(sessionId));\n    },\n    setEdugain: (uri, data) => {\n      dispatch(setEdugainUriPort(uri, data));\n    },\n\n    setEdugainRedirect: (uri) => {\n      dispatch(setEdugainRedirectUri(uri));\n    },\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(IssueEdugain);\n"]},"metadata":{},"sourceType":"module"}