{"ast":null,"code":"var __jsx = React.createElement;\nimport React from \"react\";\nimport { setSessionData, addToSelection, addSetToSelection, setStepperSteps, setEndpoint, setBaseUrl } from \"../../../store\";\nimport Layout from \"../../../components/Layout\";\nimport { connect } from \"react-redux\";\nimport Link from \"next/link\";\nimport { Button, Row, Col, Card, Container } from \"react-bootstrap\";\nimport MyStepper from \"../../../components/Layout\";\n\nclass IssueEidas extends React.Component {\n  constructor(props) {\n    super(props);\n    this.dispatch = props.dispatch;\n    this.isFetching = props.isFetching;\n    this.sessionData = props.sessionData;\n  }\n\n  static async getInitialProps({\n    reduxStore,\n    req\n  }) {\n    let userSessionData;\n\n    if (true) {\n      userSessionData = req.session.userData;\n      reduxStore.dispatch(setEndpoint(req.session.enpoint));\n      let baseUrl = req.session.baseUrl ? `/${req.session.baseUrl}/` : \"\";\n      reduxStore.dispatch(setBaseUrl(baseUrl));\n    } else {\n      if (reduxStore.getState().sessionData) {\n        userSessionData = reduxStore.getState().sessionData;\n      } else {\n        console.log(`no server session data found`);\n      }\n    }\n\n    if (userSessionData) {\n      reduxStore.dispatch(setSessionData(userSessionData));\n    } //returned value here is getting mered with the mapstatetoprops\n    // mapstatetoprops overrides these values if they match\n\n\n    return {\n      sessionData: userSessionData,\n      qrData: reduxStore.getState().qrData\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.sessionData && this.props.sessionData.eidas) {\n      // console.log(`issue-eidas::`);\n      // console.log(this.props.sessionData.eidas);\n      let toSelect = [this.props.sessionData.eidas]; // console.log(`issue-eidas::`);\n\n      this.props.setEidasToSelection(toSelect);\n      this.props.setSteps([{\n        title: 'Authenticate over \"eIDAS-eID\"'\n      }, {\n        title: \"Request Issuance\"\n      }, {\n        title: \"Accept Verifiable Credential\"\n      }]);\n    }\n  }\n\n  render() {\n    const hasRequiredAttributes = this.props.sessionData !== null && this.props.sessionData !== undefined && this.props.sessionData.eidas !== undefined;\n    console.log(`issue-eidas.js:: hasRequiredAttributes ${hasRequiredAttributes} `);\n    let path = `${this.props.baseUrl}test/eidas-authenticate`;\n    let eIDASLoginButton = !hasRequiredAttributes ? __jsx(\"a\", {\n      className: \"btn btn-primary\",\n      href: path,\n      role: \"button\"\n    }, \"eIDAS\") : __jsx(Button, {\n      variant: \"primary\",\n      disabled: true\n    }, \"eIDAS\"); // let vcIssuanceLink = this.props.baseUrl?`${this.props.baseUrl}issue/SEAL-EIDAS`:'/issue/SEAL-EIDAS'\n    // let vcIssuanceHref = this.props.baseUrl?`issue/[vcType]]`:'/issue/[vcType]'\n\n    let vcIssuanceLink = \"/issue/SEAL-EIDAS\";\n    let vcIssuanceHref = \"/issue/[vcType]\";\n\n    let eidasCard = __jsx(Card, {\n      className: \"text-center\",\n      style: {\n        marginTop: \"2rem\"\n      }\n    }, __jsx(Card.Header, null, \"Issue an eIDAS based Verifiable Credential\"), __jsx(Card.Body, null, __jsx(Card.Title, null, hasRequiredAttributes ? \"Credentials Issuance is ready!\" : \"Please authenticate to the required data sources\"), __jsx(Card.Text, null, \"Once you have authenticated through the required data sources, click the \\\"Issue\\\" button to generate and receive your VC .\"), __jsx(Container, null, __jsx(Row, null, __jsx(Col, null, eIDASLoginButton), __jsx(Col, null, __jsx(Link, {\n      as: vcIssuanceLink,\n      href: vcIssuanceHref\n    }, __jsx(Button, {\n      variant: \"primary\",\n      disabled: !hasRequiredAttributes\n    }, \"Issue Verifiable Claim\")))))));\n\n    let stepNumber = hasRequiredAttributes ? 1 : 0;\n    let stepperSteps = [{\n      title: 'Authenticate over \"eIDAS-eID\"'\n    }, {\n      title: \"Request Issuance\"\n    }, {\n      title: \"Accept Verifiable Credential\"\n    }];\n    return __jsx(Layout, null, __jsx(Row, null, __jsx(Col, null, __jsx(MyStepper, {\n      steps: stepperSteps,\n      activeNum: stepNumber // completeColor={\"#00c642\"}\n\n    }))), eidasCard);\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    isFetching: state.fetching,\n    qrData: state.qrData,\n    sessionData: state.sessionData,\n    userSelection: state.userSelection,\n    // the attributes selected by the user to be included in a VC,\n    baseUrl: state.baseUrl\n  };\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setEidasToSelection: set => {\n      dispatch(addSetToSelection(set));\n    },\n    setSteps: steps => {\n      dispatch(setStepperSteps(steps));\n    },\n    setEndPoint: endpont => {\n      dispatch(setEndpoint(endpoint));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(IssueEidas);","map":{"version":3,"names":["React","setSessionData","addToSelection","addSetToSelection","setStepperSteps","setEndpoint","setBaseUrl","Layout","connect","Link","Button","Row","Col","Card","Container","MyStepper","IssueEidas","Component","constructor","props","dispatch","isFetching","sessionData","getInitialProps","reduxStore","req","userSessionData","session","userData","enpoint","baseUrl","getState","console","log","qrData","componentDidMount","eidas","toSelect","setEidasToSelection","setSteps","title","render","hasRequiredAttributes","undefined","path","eIDASLoginButton","vcIssuanceLink","vcIssuanceHref","eidasCard","marginTop","stepNumber","stepperSteps","mapStateToProps","state","fetching","userSelection","mapDispatchToProps","set","steps","setEndPoint","endpont","endpoint"],"sources":["/home/ni/code/js/jolocom-seal-issuer/pages/vc/issue/eidas.js"],"sourcesContent":["import React from \"react\";\nimport {\n  setSessionData,\n  addToSelection,\n  addSetToSelection,\n  setStepperSteps,\n  setEndpoint,\n  setBaseUrl\n} from \"../../../store\";\nimport Layout from \"../../../components/Layout\";\nimport { connect } from \"react-redux\";\nimport Link from \"next/link\";\nimport { Button, Row, Col, Card, Container } from \"react-bootstrap\";\nimport MyStepper from \"../../../components/Layout\";\n\nclass IssueEidas extends React.Component {\n  constructor(props) {\n    super(props);\n    this.dispatch = props.dispatch;\n    this.isFetching = props.isFetching;\n    this.sessionData = props.sessionData;\n  }\n\n  static async getInitialProps({ reduxStore, req }) {\n    let userSessionData;\n    if (typeof window === \"undefined\") {\n      userSessionData = req.session.userData;\n      reduxStore.dispatch(setEndpoint(req.session.enpoint));\n      let baseUrl = req.session.baseUrl ? `/${req.session.baseUrl}/` : \"\";\n      reduxStore.dispatch(setBaseUrl(baseUrl));\n    } else {\n      if (reduxStore.getState().sessionData) {\n        userSessionData = reduxStore.getState().sessionData;\n      } else {\n        console.log(`no server session data found`);\n      }\n    }\n    if (userSessionData) {\n      reduxStore.dispatch(setSessionData(userSessionData));\n    }\n    //returned value here is getting mered with the mapstatetoprops\n    // mapstatetoprops overrides these values if they match\n    return {\n      sessionData: userSessionData,\n      qrData: reduxStore.getState().qrData\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.sessionData && this.props.sessionData.eidas) {\n      // console.log(`issue-eidas::`);\n      // console.log(this.props.sessionData.eidas);\n      let toSelect = [this.props.sessionData.eidas];\n      // console.log(`issue-eidas::`);\n      this.props.setEidasToSelection(toSelect);\n      this.props.setSteps([\n        { title: 'Authenticate over \"eIDAS-eID\"' },\n        { title: \"Request Issuance\" },\n        { title: \"Accept Verifiable Credential\" }\n      ]);\n    }\n  }\n\n  render() {\n    const hasRequiredAttributes =\n      this.props.sessionData !== null &&\n      this.props.sessionData !== undefined &&\n      this.props.sessionData.eidas !== undefined;\n\n    console.log(\n      `issue-eidas.js:: hasRequiredAttributes ${hasRequiredAttributes} `\n    );\n\n    let path = `${this.props.baseUrl}test/eidas-authenticate`;\n\n    let eIDASLoginButton = !hasRequiredAttributes ? (\n      <a className=\"btn btn-primary\" href={path} role=\"button\">\n        eIDAS\n      </a>\n    ) : (\n      <Button variant=\"primary\" disabled>\n        eIDAS\n      </Button>\n    );\n\n    // let vcIssuanceLink = this.props.baseUrl?`${this.props.baseUrl}issue/SEAL-EIDAS`:'/issue/SEAL-EIDAS'\n    // let vcIssuanceHref = this.props.baseUrl?`issue/[vcType]]`:'/issue/[vcType]'\n\n    let vcIssuanceLink = \"/issue/SEAL-EIDAS\";\n    let vcIssuanceHref = \"/issue/[vcType]\";\n    let eidasCard = (\n      <Card className=\"text-center\" style={{ marginTop: \"2rem\" }}>\n        <Card.Header>Issue an eIDAS based Verifiable Credential</Card.Header>\n        <Card.Body>\n          <Card.Title>\n            {hasRequiredAttributes\n              ? \"Credentials Issuance is ready!\"\n              : \"Please authenticate to the required data sources\"}\n          </Card.Title>\n          <Card.Text>\n            Once you have authenticated through the required data sources, click\n            the \"Issue\" button to generate and receive your VC .\n          </Card.Text>\n          <Container>\n            <Row>\n              <Col>{eIDASLoginButton}</Col>\n              <Col>\n                <Link as={vcIssuanceLink} href={vcIssuanceHref}>\n                  <Button variant=\"primary\" disabled={!hasRequiredAttributes}>\n                    Issue Verifiable Claim\n                  </Button>\n                </Link>\n              </Col>\n            </Row>\n          </Container>\n        </Card.Body>\n        {/* <Card.Footer className=\"text-muted\">2 days ago</Card.Footer> */}\n      </Card>\n    );\n    let stepNumber = hasRequiredAttributes ? 1 : 0;\n    let stepperSteps = [\n      { title: 'Authenticate over \"eIDAS-eID\"' },\n      { title: \"Request Issuance\" },\n      { title: \"Accept Verifiable Credential\" }\n    ];\n    return (\n      <Layout>\n        <Row>\n          <Col>\n            <MyStepper\n              steps={stepperSteps}\n              activeNum={stepNumber}\n              // completeColor={\"#00c642\"}\n            />\n          </Col>\n        </Row>\n        {eidasCard}\n\n        {/* <Row>\n          <div className=\"col\" style={{marginTop:\"1.5rem\"}}>\n            <Link href={this.props.baseUrl?`${this.props.baseUrl}`:\"/\"}>\n              <Button variant=\"primary\" className=\"float-right\">\n                Home\n              </Button>\n            </Link>\n          </div>\n        </Row> */}\n      </Layout>\n    );\n  }\n}\nfunction mapStateToProps(state) {\n  return {\n    isFetching: state.fetching,\n    qrData: state.qrData,\n    sessionData: state.sessionData,\n    userSelection: state.userSelection, // the attributes selected by the user to be included in a VC,\n    baseUrl: state.baseUrl\n  };\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setEidasToSelection: set => {\n      dispatch(addSetToSelection(set));\n    },\n    setSteps: steps => {\n      dispatch(setStepperSteps(steps));\n    },\n    setEndPoint: endpont => {\n      dispatch(setEndpoint(endpoint));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(IssueEidas);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}